{"ast":null,"code":"const randomFromInterval = interval => Math.random() * (interval[1] - interval[0]) + interval[0];\n\nclass FountainItem {\n  constructor(props) {\n    this.animationSpeed = props.animationSpeed;\n    this.power = props.power;\n    this.g = props.gravity;\n    this.rotationSpeed = props.rotationSpeed;\n    this.canvas = props.canvasRef;\n    this.spreadAngle = props.spreadAngle;\n    this.itemsSize = [props.minItemsSize, props.maxItemsSize];\n    this.period = 60; // подумать\n\n    this.id = props.id;\n    this.skin = props.imgSkins[this.id % props.imgSkins.length];\n    this.resetParams();\n  }\n\n  resetParams() {\n    this.t = 0;\n    this.shotAngle = randomFromInterval([Math.PI * (180 - this.spreadAngle) / 360, Math.PI * (180 + this.spreadAngle) / 360]);\n    this.width = randomFromInterval(this.itemsSize);\n    this.x = (this.canvas.current.width - this.width) / 2;\n    this.y = this.canvas.current.height;\n  }\n\n  incrementTime() {\n    this.t += this.animationSpeed * this.period / 1000;\n  }\n\n  move() {\n    const canvas = this.canvas.current;\n    this.incrementTime();\n    this.x = (canvas.width - this.width) / 2 + this.power * this.t * Math.cos(this.shotAngle);\n    this.y = canvas.height - this.power * this.t * Math.sin(this.shotAngle) + this.g * this.t * this.t / 2;\n\n    if (this.y > canvas.height + 2 * this.width || this.y < -2 * this.width || this.x > canvas.width + 2 * this.width || this.x < -2 * this.width) {\n      this.resetParams();\n    }\n  }\n\n  render() {\n    document.addEventListener('load', () => {\n      const fountainAnimator = new FountainAnimator({\n        animationSpeed: 2.9,\n        power: 155,\n        itemsNumber: 52,\n        spreadAngle: 99,\n        gravity: 8,\n        minItemsSize: 215,\n        maxItemsSize: 421,\n        rotationSpeed: 0.7,\n        imgSkins: [img1, img2],\n        canvasRef: fountainCanvasRef\n      });\n      fountainAnimator.start();\n    });\n    const context = this.canvas.current.getContext('2d');\n    context.translate(this.x + this.width / 2, this.y + this.width / 2);\n    context.rotate(this.t * this.rotationSpeed * (2 * (this.id % 2) - 1));\n    context.translate(-this.x - this.width / 2, -this.y - this.width / 2);\n    context.drawImage(this.skin, this.x, this.y, this.width, this.width);\n    context.restore();\n    this.move();\n  }\n\n}\n\nclass FountainAnimator {\n  constructor(props) {\n    this.state = props;\n    this.canvas = props.canvasRef;\n    this.context = props.canvasRef.current.context;\n    this.setCanvasSize();\n    window.addEventListener('resize', () => this.setCanvasSize());\n  }\n\n  setCanvasSize() {\n    this.canvas.current.width = window.innerWidth;\n    this.canvas.current.height = window.innerHeight;\n  }\n\n  start() {\n    console.log('Начинаем!');\n    const context = this.canvas.current.getContext('2d');\n    const items = [];\n\n    for (let i = 0; i < this.state.itemsNumber; i++) {\n      items.push(new FountainItem({ ...this.state,\n        id: i\n      }));\n    }\n\n    const tick = timestamp => {\n      requestAnimationFrame(tick);\n      context.clearRect(0, 0, this.canvas.current.width, this.canvas.current.height);\n      items.forEach(item => item.render());\n    };\n\n    requestAnimationFrame(tick);\n  }\n\n}\n\nexport default FountainAnimator;","map":{"version":3,"sources":["/home/alex/projects/test_ts_app/src/fountain.js"],"names":["randomFromInterval","interval","Math","random","FountainItem","constructor","props","animationSpeed","power","g","gravity","rotationSpeed","canvas","canvasRef","spreadAngle","itemsSize","minItemsSize","maxItemsSize","period","id","skin","imgSkins","length","resetParams","t","shotAngle","PI","width","x","current","y","height","incrementTime","move","cos","sin","render","document","addEventListener","fountainAnimator","FountainAnimator","itemsNumber","img1","img2","fountainCanvasRef","start","context","getContext","translate","rotate","drawImage","restore","state","setCanvasSize","window","innerWidth","innerHeight","console","log","items","i","push","tick","timestamp","requestAnimationFrame","clearRect","forEach","item"],"mappings":"AAAA,MAAMA,kBAAkB,GAAIC,QAAD,IACzBC,IAAI,CAACC,MAAL,MAAiBF,QAAQ,CAAC,CAAD,CAAR,GAAcA,QAAQ,CAAC,CAAD,CAAvC,IAA8CA,QAAQ,CAAC,CAAD,CADxD;;AAGA,MAAMG,YAAN,CAAmB;AACjBC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,SAAKC,cAAL,GAAsBD,KAAK,CAACC,cAA5B;AACA,SAAKC,KAAL,GAAaF,KAAK,CAACE,KAAnB;AACA,SAAKC,CAAL,GAASH,KAAK,CAACI,OAAf;AACA,SAAKC,aAAL,GAAqBL,KAAK,CAACK,aAA3B;AACA,SAAKC,MAAL,GAAcN,KAAK,CAACO,SAApB;AACA,SAAKC,WAAL,GAAmBR,KAAK,CAACQ,WAAzB;AACA,SAAKC,SAAL,GAAiB,CAACT,KAAK,CAACU,YAAP,EAAqBV,KAAK,CAACW,YAA3B,CAAjB;AACA,SAAKC,MAAL,GAAc,EAAd,CARiB,CAQA;;AACjB,SAAKC,EAAL,GAAUb,KAAK,CAACa,EAAhB;AACA,SAAKC,IAAL,GAAYd,KAAK,CAACe,QAAN,CAAe,KAAKF,EAAL,GAAUb,KAAK,CAACe,QAAN,CAAeC,MAAxC,CAAZ;AACA,SAAKC,WAAL;AACD;;AAEDA,EAAAA,WAAW,GAAG;AACZ,SAAKC,CAAL,GAAS,CAAT;AACA,SAAKC,SAAL,GAAiBzB,kBAAkB,CAAC,CACjCE,IAAI,CAACwB,EAAL,IAAW,MAAM,KAAKZ,WAAtB,CAAD,GAAuC,GADL,EAEjCZ,IAAI,CAACwB,EAAL,IAAW,MAAM,KAAKZ,WAAtB,CAAD,GAAuC,GAFL,CAAD,CAAnC;AAIA,SAAKa,KAAL,GAAa3B,kBAAkB,CAAC,KAAKe,SAAN,CAA/B;AACA,SAAKa,CAAL,GAAS,CAAC,KAAKhB,MAAL,CAAYiB,OAAZ,CAAoBF,KAApB,GAA4B,KAAKA,KAAlC,IAA2C,CAApD;AACA,SAAKG,CAAL,GAAS,KAAKlB,MAAL,CAAYiB,OAAZ,CAAoBE,MAA7B;AACD;;AAEDC,EAAAA,aAAa,GAAG;AACd,SAAKR,CAAL,IAAW,KAAKjB,cAAL,GAAsB,KAAKW,MAA5B,GAAsC,IAAhD;AACD;;AAEDe,EAAAA,IAAI,GAAG;AACL,UAAMrB,MAAM,GAAG,KAAKA,MAAL,CAAYiB,OAA3B;AACA,SAAKG,aAAL;AACA,SAAKJ,CAAL,GACE,CAAChB,MAAM,CAACe,KAAP,GAAe,KAAKA,KAArB,IAA8B,CAA9B,GACA,KAAKnB,KAAL,GAAa,KAAKgB,CAAlB,GAAsBtB,IAAI,CAACgC,GAAL,CAAS,KAAKT,SAAd,CAFxB;AAGA,SAAKK,CAAL,GACElB,MAAM,CAACmB,MAAP,GACA,KAAKvB,KAAL,GAAa,KAAKgB,CAAlB,GAAsBtB,IAAI,CAACiC,GAAL,CAAS,KAAKV,SAAd,CADtB,GAEC,KAAKhB,CAAL,GAAS,KAAKe,CAAd,GAAkB,KAAKA,CAAxB,GAA6B,CAH/B;;AAIA,QACE,KAAKM,CAAL,GAASlB,MAAM,CAACmB,MAAP,GAAgB,IAAI,KAAKJ,KAAlC,IACA,KAAKG,CAAL,GAAS,CAAC,CAAD,GAAK,KAAKH,KADnB,IAEA,KAAKC,CAAL,GAAShB,MAAM,CAACe,KAAP,GAAe,IAAI,KAAKA,KAFjC,IAGA,KAAKC,CAAL,GAAS,CAAC,CAAD,GAAK,KAAKD,KAJrB,EAKE;AACA,WAAKJ,WAAL;AACD;AACF;;AAEDa,EAAAA,MAAM,GAAG;AACPC,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,MAA1B,EAAkC,MAAM;AACtC,YAAMC,gBAAgB,GAAG,IAAIC,gBAAJ,CAAqB;AAC5CjC,QAAAA,cAAc,EAAE,GAD4B;AAE5CC,QAAAA,KAAK,EAAE,GAFqC;AAG5CiC,QAAAA,WAAW,EAAE,EAH+B;AAI5C3B,QAAAA,WAAW,EAAE,EAJ+B;AAK5CJ,QAAAA,OAAO,EAAE,CALmC;AAM5CM,QAAAA,YAAY,EAAE,GAN8B;AAO5CC,QAAAA,YAAY,EAAE,GAP8B;AAQ5CN,QAAAA,aAAa,EAAE,GAR6B;AAS5CU,QAAAA,QAAQ,EAAE,CAACqB,IAAD,EAAOC,IAAP,CATkC;AAU5C9B,QAAAA,SAAS,EAAE+B;AAViC,OAArB,CAAzB;AAYAL,MAAAA,gBAAgB,CAACM,KAAjB;AACC,KAdH;AAeA,UAAMC,OAAO,GAAG,KAAKlC,MAAL,CAAYiB,OAAZ,CAAoBkB,UAApB,CAA+B,IAA/B,CAAhB;AACAD,IAAAA,OAAO,CAACE,SAAR,CAAkB,KAAKpB,CAAL,GAAS,KAAKD,KAAL,GAAa,CAAxC,EAA2C,KAAKG,CAAL,GAAS,KAAKH,KAAL,GAAa,CAAjE;AACAmB,IAAAA,OAAO,CAACG,MAAR,CAAe,KAAKzB,CAAL,GAAS,KAAKb,aAAd,IAA+B,KAAK,KAAKQ,EAAL,GAAU,CAAf,IAAoB,CAAnD,CAAf;AACA2B,IAAAA,OAAO,CAACE,SAAR,CAAkB,CAAC,KAAKpB,CAAN,GAAU,KAAKD,KAAL,GAAa,CAAzC,EAA4C,CAAC,KAAKG,CAAN,GAAU,KAAKH,KAAL,GAAa,CAAnE;AACAmB,IAAAA,OAAO,CAACI,SAAR,CAAkB,KAAK9B,IAAvB,EAA6B,KAAKQ,CAAlC,EAAqC,KAAKE,CAA1C,EAA6C,KAAKH,KAAlD,EAAyD,KAAKA,KAA9D;AACAmB,IAAAA,OAAO,CAACK,OAAR;AACA,SAAKlB,IAAL;AACD;;AAzEgB;;AA4EnB,MAAMO,gBAAN,CAAuB;AACrBnC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,SAAK8C,KAAL,GAAa9C,KAAb;AACA,SAAKM,MAAL,GAAcN,KAAK,CAACO,SAApB;AACA,SAAKiC,OAAL,GAAexC,KAAK,CAACO,SAAN,CAAgBgB,OAAhB,CAAwBiB,OAAvC;AACA,SAAKO,aAAL;AACAC,IAAAA,MAAM,CAAChB,gBAAP,CAAwB,QAAxB,EAAkC,MAAM,KAAKe,aAAL,EAAxC;AACD;;AAEDA,EAAAA,aAAa,GAAG;AACd,SAAKzC,MAAL,CAAYiB,OAAZ,CAAoBF,KAApB,GAA4B2B,MAAM,CAACC,UAAnC;AACA,SAAK3C,MAAL,CAAYiB,OAAZ,CAAoBE,MAApB,GAA6BuB,MAAM,CAACE,WAApC;AACD;;AAEDX,EAAAA,KAAK,GAAG;AACNY,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACA,UAAMZ,OAAO,GAAG,KAAKlC,MAAL,CAAYiB,OAAZ,CAAoBkB,UAApB,CAA+B,IAA/B,CAAhB;AACA,UAAMY,KAAK,GAAG,EAAd;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,KAAL,CAAWX,WAA/B,EAA4CmB,CAAC,EAA7C,EAAiD;AAC/CD,MAAAA,KAAK,CAACE,IAAN,CAAW,IAAIzD,YAAJ,CAAiB,EAAE,GAAG,KAAKgD,KAAV;AAAiBjC,QAAAA,EAAE,EAAEyC;AAArB,OAAjB,CAAX;AACD;;AACD,UAAME,IAAI,GAAIC,SAAD,IAAe;AAC1BC,MAAAA,qBAAqB,CAACF,IAAD,CAArB;AACAhB,MAAAA,OAAO,CAACmB,SAAR,CACE,CADF,EAEE,CAFF,EAGE,KAAKrD,MAAL,CAAYiB,OAAZ,CAAoBF,KAHtB,EAIE,KAAKf,MAAL,CAAYiB,OAAZ,CAAoBE,MAJtB;AAMA4B,MAAAA,KAAK,CAACO,OAAN,CAAeC,IAAD,IAAUA,IAAI,CAAC/B,MAAL,EAAxB;AACD,KATD;;AAUA4B,IAAAA,qBAAqB,CAACF,IAAD,CAArB;AACD;;AAhCoB;;AAmCvB,eAAetB,gBAAf","sourcesContent":["const randomFromInterval = (interval) =>\n  Math.random() * (interval[1] - interval[0]) + interval[0]\n\nclass FountainItem {\n  constructor(props) {\n    this.animationSpeed = props.animationSpeed\n    this.power = props.power\n    this.g = props.gravity\n    this.rotationSpeed = props.rotationSpeed\n    this.canvas = props.canvasRef\n    this.spreadAngle = props.spreadAngle\n    this.itemsSize = [props.minItemsSize, props.maxItemsSize]\n    this.period = 60 // подумать\n    this.id = props.id\n    this.skin = props.imgSkins[this.id % props.imgSkins.length]\n    this.resetParams()\n  }\n\n  resetParams() {\n    this.t = 0\n    this.shotAngle = randomFromInterval([\n      (Math.PI * (180 - this.spreadAngle)) / 360,\n      (Math.PI * (180 + this.spreadAngle)) / 360,\n    ])\n    this.width = randomFromInterval(this.itemsSize)\n    this.x = (this.canvas.current.width - this.width) / 2\n    this.y = this.canvas.current.height\n  }\n\n  incrementTime() {\n    this.t += (this.animationSpeed * this.period) / 1000\n  }\n\n  move() {\n    const canvas = this.canvas.current\n    this.incrementTime()\n    this.x =\n      (canvas.width - this.width) / 2 +\n      this.power * this.t * Math.cos(this.shotAngle)\n    this.y =\n      canvas.height -\n      this.power * this.t * Math.sin(this.shotAngle) +\n      (this.g * this.t * this.t) / 2\n    if (\n      this.y > canvas.height + 2 * this.width ||\n      this.y < -2 * this.width ||\n      this.x > canvas.width + 2 * this.width ||\n      this.x < -2 * this.width\n    ) {\n      this.resetParams()\n    }\n  }\n\n  render() {\n    document.addEventListener('load', () => {\n      const fountainAnimator = new FountainAnimator({\n        animationSpeed: 2.9,\n        power: 155,\n        itemsNumber: 52,\n        spreadAngle: 99,\n        gravity: 8,\n        minItemsSize: 215,\n        maxItemsSize: 421,\n        rotationSpeed: 0.7,\n        imgSkins: [img1, img2],\n        canvasRef: fountainCanvasRef,\n      })\n      fountainAnimator.start()\n      })\n    const context = this.canvas.current.getContext('2d')\n    context.translate(this.x + this.width / 2, this.y + this.width / 2)\n    context.rotate(this.t * this.rotationSpeed * (2 * (this.id % 2) - 1))\n    context.translate(-this.x - this.width / 2, -this.y - this.width / 2)\n    context.drawImage(this.skin, this.x, this.y, this.width, this.width)\n    context.restore()\n    this.move()\n  }\n}\n\nclass FountainAnimator {\n  constructor(props) {\n    this.state = props\n    this.canvas = props.canvasRef\n    this.context = props.canvasRef.current.context\n    this.setCanvasSize()\n    window.addEventListener('resize', () => this.setCanvasSize())\n  }\n\n  setCanvasSize() {\n    this.canvas.current.width = window.innerWidth\n    this.canvas.current.height = window.innerHeight\n  }\n\n  start() {\n    console.log('Начинаем!')\n    const context = this.canvas.current.getContext('2d')\n    const items = []\n    for (let i = 0; i < this.state.itemsNumber; i++) {\n      items.push(new FountainItem({ ...this.state, id: i }))\n    }\n    const tick = (timestamp) => {\n      requestAnimationFrame(tick)\n      context.clearRect(\n        0,\n        0,\n        this.canvas.current.width,\n        this.canvas.current.height,\n      )\n      items.forEach((item) => item.render())\n    }\n    requestAnimationFrame(tick)\n  }\n}\n\nexport default FountainAnimator\n"]},"metadata":{},"sourceType":"module"}